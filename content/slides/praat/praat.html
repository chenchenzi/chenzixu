<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Introduction to Praat and Praat Scripting</title>
    <meta charset="utf-8" />
    <meta name="author" content="Chenzi Xu" />
    <meta name="date" content="2022-01-02" />
    <script src="praat_files/header-attrs/header-attrs.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
    <link rel="stylesheet" href="custom.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Introduction to Praat and Praat Scripting
## Lab Skillz Workshop
### Chenzi Xu
### 2022-01-02

---






# Our Goal

.left-column[
### First

### Second

### Third
]

.right-column[
.big[To know a full range of functions Praat can perform

To master how to navigate and use Praat's GUI

To learn scripting basics, parse praat script, and **start** praat scripting]

]

---
## Outline
.right-column[
1. ### [Why Praat?](#why)

1. ### [What is Praat capable of?](#functions)

1. ### [Praat scripting](#script)

1. ### Demos and Practice

]

---
class: inverse center middle

# Why Praat? ![Praat Icon](icon.png)

---

name: why

## Why Praat?

- Open source, free of charge

- Available for major computer platforms (MacOS, Windows, Linux) and systems

- Graphical User Interface

- A macro recording mechanism (Command History)

- You can create your own Praat scripts to **automate** things! 
  - Recurring tasks become less tedious and more efficient.
  - Consistent and Replicable measurement
  - Minimise human error

- You can create your own application with an autonomous GUI.
  - Python-praat package: [Parselmouth](https://parselmouth.readthedocs.io/en/stable/)
  - R-praat package: [rPraat](https://fu.ff.cuni.cz/praat/rDemo.html)


---
name: functions
class: inverse center middle

# What is Praat capable of?

--
**Creating and manipulating sounds**

**Visualizing and annotating sounds**

**Phonetic measurement and analysis**

**Creating publication-quality plots**

**Conducting phonetic experiment**

---
name: chart
background-image: url('praat.png')
background-size: cover
background-position: middle right


---

## Are you familiar with these tasks?

- Loading files

- Managing objects (create, copy, rename, save, remove)

- View objects and analyses

- Setting analysis parameters

- Querying objects (using buttons or menu commands)

- TextGrid annotation

---

## What does Praat contain?
.pull-l[
###Praat Objects
- Sound
- TextGrid
- Spectrogram
- Pitch, PitchTier
- Intensity, IntensityTier
- ExperimentMFC
- ...
]

.pull-m[
###Praat Editors
- SoundEditor
- TextGridEditor
- PitchEditor
- PointEditor
- SpectrumEditor
- ...
]

.pull-r[
###Praat Commands
- To Intensity...
- To TextGrid...
- Zoom in
- Get Minimum
- Convert to mono
- ...
]

&gt; You must select the correct object/environment to issue the right commands!
---
name: script
class: inverse center middle

# Praat Script

--
**String and numeric variables**

**For loops, if else statements, while loops**

**Regular expression matching**

**Comments**

**Syntax**

---
background-image: url('pitch1.png')
background-size: 32% 56%
background-position: 10% 90%
## Scripting Hacks I
### Check GUI for Syntax

.pull-right[
![Arguments for "To Pitch"](pitch2.png)


```r
*To Pitch: 0.0, 75.0, 600.0
```

]

---
## Scripting Hacks II
### Macro Recording Workflow (Command History)
```
1. New Praat Script
2. Edit &gt; Clear history (script editor)
3. GUI actions
4. Edit &gt; Paste history (script editor)
```

---
background-image: url('save.png')
background-size: 40% 70%
background-position: 90% 80%

## Scripting Hacks III
### Parse others' script and adapt

.pull-left[

- Parse the script in chunks and see if they suit your needs. Sometimes no need to reinvent the wheels.

- Learn from others' script.
&gt; Be cautious when using others'script. 
&gt; **Test** it out first and remember to **cite** it!
&gt;
&gt; **Save frequently!**
]

---
## Scripting Hacks IV
.left-column[
### Boilerplate code

Place all paths, input/output files, and global variables at the top

Paths must end with a backslash /

Paths can be **relative** or **absolute**
]
.right-column[

```r
*dir$ = "/Users/Chenzi/mydir/data/"

Create Strings as file list: "file_list", dir$ + "*.wav"
nFiles = Get number of strings

for i from 1 to nFiles
    selectObject: "Strings file_list"
    filename$ = Get string: i
    basename$ = filename$ - ".wav"
    Read from file: dir$ + filename$
    
    ########################
    #### MORE CODE HERE ####
    ########################
    
endfor
```
]
---
## Scripting Hacks IV
.left-column[
### Boilerplate code
Create list of all .wav files in the directory and save the number to a variable

variable ends in `$`, strings wrapped in `""`
]
.right-column[

```r
dir$ = "/Users/Chenzi/mydir/data/" 

*Create Strings as file list: "file_list", dir$ + "*.wav"
*nFiles = Get number of strings

for i from 1 to nFiles
    selectObject: "Strings file_list"
    filename$ = Get string: i
    basename$ = filename$ - ".wav"
    Read from file: dir$ + filename$
    
    ########################
    #### MORE CODE HERE ####
    ########################
    
endfor
```
]

---
## Scripting Hacks IV
.left-column[
### Boilerplate code
Set up a for loop to iterate over all files on the list

`1` is the starting point. It `+1` each time through the loop
]
.right-column[

```r
dir$ = "/Users/Chenzi/mydir/data/" 

Create Strings as file list: "file_list", dir$ + "*.wav"
nFiles = Get number of strings

*for i from 1 to nFiles
    selectObject: "Strings file_list"
    filename$ = Get string: i
    basename$ = filename$ - ".wav"
    Read from file: dir$ + filename$
    
    ########################
    #### MORE CODE HERE ####
    ########################
    
*endfor
```
]


---
## Scripting Hacks IV
.left-column[
### Boilerplate code
Read in each .wav file.

`Get string` : get the nth row of the list of filenames

]
.right-column[

```r
dir$ = "/Users/Chenzi/mydir/data/" 

Create Strings as file list: "file_list", dir$ + "*.wav"
nFiles = Get number of strings

for i from 1 to nFiles
*   selectObject: "Strings file_list"
*   filename$ = Get string: i
*   basename$ = filename$ - ".wav"
*   Read from file: dir$ + filename$
    
    ########################
    #### MORE CODE HERE ####
    ########################
    
endfor
```
]

---
class: inverse center middle

# Demos and Practice
Task 1: Get total duration of all .wav files

Task 2: Measure f0 in specified interval

---
## Task 1

### Step 1: How to get duration of one .wav file
1. Open one .wav file in Praat `Open &gt; Read from file`
1. Select the Sound object, click `Query &gt; Query time domain &gt; Get total duration`

![:scale 50%](duration.png)


---
## Task 1

### Step 2: Print command history

.pull-left[
1. ```Praat &gt; New Praat script```
1. In the script editor, click ```Edit &gt; Paste history```
1. ```File &gt; Save``` and ```Run```

![:scale 120%](history.png)
]

.pull-right[
&gt; Limitations: 
&gt;
&gt; Query commands may behave different in scripts than in the GUI (Praat scripting assumes that you want to handle the query result inside the script)
&gt;
&gt; Changing scripting environments is not recorded

]

---
## Task 1

### Step 3: Loop over all .wav files




---
layout: false

## Square image

&lt;center&gt;&lt;img src="https://octodex.github.com/images/labtocat.png" alt="GithHub Octocat" height="400px" /&gt;&lt;/center&gt;

.footnote[GitHub Octocat]

---

### Definition lists can be used with HTML syntax.

&lt;dl&gt;
&lt;dt&gt;Name&lt;/dt&gt;
&lt;dd&gt;Godzilla&lt;/dd&gt;
&lt;dt&gt;Born&lt;/dt&gt;
&lt;dd&gt;1952&lt;/dd&gt;
&lt;dt&gt;Birthplace&lt;/dt&gt;
&lt;dd&gt;Japan&lt;/dd&gt;
&lt;dt&gt;Color&lt;/dt&gt;
&lt;dd&gt;Green&lt;/dd&gt;
&lt;/dl&gt;

---
class: center, middle

# Thanks!

Slides created via the R packages:

Theme design from [Katie Jolly](https://www.katiejolly.io/blog/2021-03-16/designing-slides)

[**xaringan**](https://github.com/yihui/xaringan)&lt;br&gt;
[gadenbuie/xaringanthemer](https://github.com/gadenbuie/xaringanthemer)

The chakra comes from [remark.js](https://remarkjs.com), [**knitr**](http://yihui.name/knitr), and [R Markdown](https://rmarkdown.rstudio.com).
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="macros.js"></script>
<script>var slideshow = remark.create({
"slideNumberFormat": "%current%",
"highlightStyle": "github",
"highlightLines": true,
"ratio": "16:9",
"countIncrementalSlides": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
