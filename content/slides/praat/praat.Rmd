---
title: "Introduction to Praat and Praat Scripting"
subtitle: "Lab Skillz Workshop"  
author: 
  - "Chenzi Xu"
date: '`r Sys.Date()`'
output:
  xaringan::moon_reader:
    css: [xaringan-themer.css, custom.css]
    nature:
      slideNumberFormat: "%current%"
      highlightStyle: github
      highlightLines: true
      ratio: 16:9
      countIncrementalSlides: true
      beforeInit: "macros.js"
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(
  fig.width=9, fig.height=3.5, fig.retina=3,
  out.width = "100%",
  cache = FALSE,
  echo = TRUE,
  message = FALSE, 
  warning = FALSE,
  hiline = TRUE
  #eval = TRUE
)
```

```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer)
  dark_yellow <- "#EFBE43"
  light_yellow <- "#FDF7E9"
  gray <- "#333333"
  blue <- "#4466B0"

  style_duo(
  # colors
  primary_color = light_yellow,
  secondary_color = dark_yellow,
  #inverse_header_color = "#FFFFFF"
  header_color = gray,
  text_color = gray,
  code_inline_color = colorspace::lighten(gray),
  text_bold_color = colorspace::lighten(gray),
  link_color = blue,
  #title_slide_text_color = blue,

  # fonts
  header_font_google = google_font("Martel", "300", "400"),
  text_font_google = google_font("Lato"),
  code_font_google = google_font("Fira Mono")
  
)
```

# Our Goal

.left-column[
### First

### Second

### Third
]

.right-column[
.big[To know a full range of functions Praat can perform

To master how to navigate and use Praat's GUI

To learn scripting basics, parse praat script, and **start** praat scripting]

]

---
## Outline
.right-column[
1. ### [Why Praat?](#why)

1. ### [What is Praat capable of?](#functions)

1. ### [Praat scripting](#script)

1. ### Demos and Practice

]

---
class: inverse center middle

# Why Praat? ![Praat Icon](icon.png)

---

name: why

## Why Praat?

- Open source, free of charge

- Available for major computer platforms (MacOS, Windows, Linux) and systems

- Graphical User Interface

- A macro recording mechanism (Command History)

- You can create your own Praat scripts to **automate** things! 
  - Recurring tasks become less tedious and more efficient.
  - Consistent and Replicable measurement
  - Minimise human error

- You can create your own application with an autonomous GUI.
  - Python-praat package: [Parselmouth](https://parselmouth.readthedocs.io/en/stable/)
  - R-praat package: [rPraat](https://fu.ff.cuni.cz/praat/rDemo.html)


---
name: functions
class: inverse center middle

# What is Praat capable of?

--
**Creating and manipulating sounds**

**Visualizing and annotating sounds**

**Phonetic measurement and analysis**

**Creating publication-quality plots**

**Conducting phonetic experiment**

---
name: chart
background-image: url('praat.png')
background-size: cover
background-position: middle right


---

## Are you familiar with these tasks?

- Loading files

- Managing objects (create, copy, rename, save, remove)

- View objects and analyses

- Setting analysis parameters

- Querying objects (using buttons or menu commands)

- TextGrid annotation

---

## What does Praat contain?
.pull-l[
###Praat Objects
- Sound
- TextGrid
- Spectrogram
- Pitch, PitchTier
- Intensity, IntensityTier
- ExperimentMFC
- ...
]

.pull-m[
###Praat Editors
- SoundEditor
- TextGridEditor
- PitchEditor
- PointEditor
- SpectrumEditor
- ...
]

.pull-r[
###Praat Commands
- SoundEditor
- TextGridEditor
- PitchEditor
- PointEditor
- SpectrumEditor
- ...
]

> You must select the correct object to issue the right commands!
---
name: script
class: inverse center middle

# Praat Script

--
**String and numeric variables**

**For loops, if else statements, while loops**

**Regular expression matching**

**Comments**

**Syntax**

---
background-image: url('pitch1.png')
background-size: 32% 56%
background-position: 10% 90%
## Scripting Hacks I
### Check GUI for Syntax

.pull-right[
![Arguments for "To Pitch"](pitch2.png)


```
To Pitch: 0.0, 75.0, 600.0
```

]

---
## Scripting Hacks II
### Macro Recording Workflow (Command History)

```
1. New Praat Script
2. Edit > Clear history (script editor)
3. GUI actions
4. Edit > Paste history (script editor)
```

---
background-image: url('save.png')
background-size: 40% 70%
background-position: 90% 80%

## Scripting Hacks III
### Parse others' script and adapt

.pull-left[

- Parse the script in chunks and see if they suit your needs. Sometimes no need to reinvent the wheels.

- Learn from others' script.
> Be cautious when using others'script. 
> **Test** it out first and remember to **cite** it!
>
> **Save frequently!**
]


---
## Scripting Hacks IV
.left-column[
### Boilerplate code

Place all paths, input/output files, and global variables at the top

Paths must end with a backslash /

Paths can be **relative** or **absolute**
]
.right-column[
```{r, eval=FALSE}
dir$ = "/Users/Chenzi/mydir/data/" #<<

Create Strings as file list: "file_list", dir$ + "*.wav"
nFiles = Get number of strings

for i from 1 to nFiles
    selectObject: "Strings file_list"
    filename$ = Get string: i
    basename$ = filename$ - ".wav"
    Read from file: dir$ + filename$
    
    ########################
    #### MORE CODE HERE ####
    ########################
    
endfor
```
]
---
## Scripting Hacks IV
.left-column[
### Boilerplate code
Create list of all .wav files in the directory and save the number to a variable

variable ends in `$`, strings wrapped in `""`
]
.right-column[
```{r, eval=FALSE}
dir$ = "/Users/Chenzi/mydir/data/" 

Create Strings as file list: "file_list", dir$ + "*.wav" #<<
nFiles = Get number of strings #<<

for i from 1 to nFiles
    selectObject: "Strings file_list"
    filename$ = Get string: i
    basename$ = filename$ - ".wav"
    Read from file: dir$ + filename$
    
    ########################
    #### MORE CODE HERE ####
    ########################
    
endfor
```
]

---
## Scripting Hacks IV
.left-column[
### Boilerplate code
Set up a for loop to iterate over all files on the list

`1` is the starting point. It `+1` each time through the loop
]
.right-column[
```{r, eval=FALSE}
dir$ = "/Users/Chenzi/mydir/data/" 

Create Strings as file list: "file_list", dir$ + "*.wav"
nFiles = Get number of strings

for i from 1 to nFiles #<<
    selectObject: "Strings file_list"
    filename$ = Get string: i
    basename$ = filename$ - ".wav"
    Read from file: dir$ + filename$
    
    ########################
    #### MORE CODE HERE ####
    ########################
    
endfor #<<
```
]


---
## Scripting Hacks IV
.left-column[
### Boilerplate code
Read in each .wav file.

`Get string` : get the nth row of the list of filenames

]
.right-column[
```{r, eval=FALSE}
dir$ = "/Users/Chenzi/mydir/data/" 

Create Strings as file list: "file_list", dir$ + "*.wav"
nFiles = Get number of strings

for i from 1 to nFiles
    selectObject: "Strings file_list" #<<
    filename$ = Get string: i #<<
    basename$ = filename$ - ".wav" #<<
    Read from file: dir$ + filename$ #<<
    
    ########################
    #### MORE CODE HERE ####
    ########################
    
endfor
```
]

---
class: inverse center middle

# Demos and Practice
load files -> save files
measure f0


---
layout: true

## Blocks

---

### Blockquote

> This is a blockquote following a header.
>
> When something is important enough, you do it even if the odds are not in your favor.

---

### Code Blocks

#### R Code

```{r eval=FALSE}
ggplot(gapminder) +
  aes(x = gdpPercap, y = lifeExp, size = pop, color = country) +
  geom_point() +
  facet_wrap(~year)
```

#### JavaScript

```js
var fun = function lang(l) {
  dateformat.i18n = require('./lang/' + l)
  return true;
}
```

---

### More R Code

```{r eval=FALSE}
dplyr::starwars %>% dplyr::slice_sample(n = 4)
```

---

```{r message=TRUE, eval=requireNamespace("cli", quietly = TRUE)}
cli::cli_alert_success("It worked!")
```

--

```{r message=TRUE}
message("Just a friendly message")
```

--

```{r warning=TRUE}
warning("This could be bad...")
```

--

```{r error=TRUE}
stop("I hope you're sitting down for this")
```


---
layout: true

## Tables

---
exclude: `r if (requireNamespace("tibble", quietly=TRUE)) "false" else "true"`

```{r eval=requireNamespace("tibble", quietly=TRUE)}
tibble::as_tibble(mtcars)
```

---

```{r}
knitr::kable(head(mtcars), format = 'html')
```

---
exclude: `r if (requireNamespace("DT", quietly=TRUE)) "false" else "true"`

```{r eval=requireNamespace("DT", quietly=TRUE)}
DT::datatable(head(mtcars), fillContainer = FALSE, options = list(pageLength = 4))
```

---
layout: true

## Lists

---

.pull-left[
#### Here is an unordered list:

*   Item foo
*   Item bar
*   Item baz
*   Item zip
]

.pull-right[

#### And an ordered list:

1.  Item one
1.  Item two
1.  Item three
1.  Item four
]

---

### And a nested list:

- level 1 item
  - level 2 item
  - level 2 item
    - level 3 item
    - level 3 item
- level 1 item
  - level 2 item
  - level 2 item
  - level 2 item
- level 1 item
  - level 2 item
  - level 2 item
- level 1 item

---

### Nesting an ol in ul in an ol

- level 1 item (ul)
  1. level 2 item (ol)
  1. level 2 item (ol)
    - level 3 item (ul)
    - level 3 item (ul)
- level 1 item (ul)
  1. level 2 item (ol)
  1. level 2 item (ol)
    - level 3 item (ul)
    - level 3 item (ul)
  1. level 4 item (ol)
  1. level 4 item (ol)
    - level 3 item (ul)
    - level 3 item (ul)
- level 1 item (ul)

---
layout: true

## Plots

---

```{r plot-example, eval=requireNamespace("ggplot2", quietly=TRUE)}
library(ggplot2)
(g <- ggplot(mpg) + aes(hwy, cty, color = class) + geom_point())
```

---

```{r plot-example-themed, eval=requireNamespace("showtext", quietly=TRUE) && requireNamespace("ggplot2", quietly=TRUE)}
g + xaringanthemer::theme_xaringan(text_font_size = 16, title_font_size = 18) +
  ggtitle("A Plot About Cars")
```

.footnote[Requires `{showtext}`]

---
layout: false

## Square image

<center><img src="https://octodex.github.com/images/labtocat.png" alt="GithHub Octocat" height="400px" /></center>

.footnote[GitHub Octocat]

---

### Wide image

![A wide image with a diagram of branching in git.](https://docs.github.com/assets/images/help/repository/branching.png)

.footnote[Wide images scale to 100% slide width]

---

## Two images

.pull-left[
![A GitHub Octocat, style "mother hubber"](https://octodex.github.com/images/motherhubbertocat.png)
]

.pull-right[
![A GitHub Octocat, style "dinotcat"](https://octodex.github.com/images/dinotocat.png)
]

---

### Definition lists can be used with HTML syntax.

<dl>
<dt>Name</dt>
<dd>Godzilla</dd>
<dt>Born</dt>
<dd>1952</dd>
<dt>Birthplace</dt>
<dd>Japan</dd>
<dt>Color</dt>
<dd>Green</dd>
</dl>

---
class: center, middle

# Thanks!

Slides created via the R packages:

Theme design from [Katie Jolly](https://www.katiejolly.io/blog/2021-03-16/designing-slides)

[**xaringan**](https://github.com/yihui/xaringan)<br>
[gadenbuie/xaringanthemer](https://github.com/gadenbuie/xaringanthemer)

The chakra comes from [remark.js](https://remarkjs.com), [**knitr**](http://yihui.name/knitr), and [R Markdown](https://rmarkdown.rstudio.com).
